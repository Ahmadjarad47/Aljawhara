<div class="p-4 md:p-6">
    <!-- Header -->
    <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-6">
        <div>
            <h1 class="text-3xl font-bold text-base-content">{{t('myOrders')}}</h1>
            <p class="text-base-content/70 mt-2">{{t('viewAndManage')}}</p>
        </div>
        <button (click)="loadOrders()" [disabled]="isLoading()" class="btn btn-primary btn-sm">
            @if (isLoading()) {
                <span class="loading loading-spinner loading-xs"></span>
            } @else {
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
            }
            {{t('refresh')}}
        </button>
    </div>

    <!-- Search and Filters -->
    <div class="card bg-base-100 shadow-sm border border-base-300 mb-6">
        <div class="card-body p-4">
            <div class="flex flex-col md:flex-row gap-4">
                <!-- Search Input -->
                <div class="flex-1">
                    <div class="form-control">
                        <div class="input-group">
                            <input 
                                type="text" 
                                [placeholder]="t('searchPlaceholder')" 
                                class="input input-bordered flex-1" 
                                [ngModel]="searchTerm()"
                                (ngModelChange)="searchTerm.set($event)"
                                (keyup.enter)="onSearch()" />
                            <button (click)="onSearch()" [disabled]="isLoading()" class="btn btn-square">
                                @if (isLoading()) {
                                    <span class="loading loading-spinner loading-sm"></span>
                                } @else {
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                    </svg>
                                }
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Status Filter -->
                <div class="form-control">
                    <select 
                        class="select select-bordered" 
                        [ngModel]="statusFilter()"
                        (ngModelChange)="onStatusFilterChange($event)">
                        <option [ngValue]="null">{{t('allStatus')}}</option>
                        <option [ngValue]="OrderStatus.Pending">{{t('pending')}}</option>
                        <option [ngValue]="OrderStatus.Processing">{{t('processing')}}</option>
                        <option [ngValue]="OrderStatus.Shipped">{{t('shipped')}}</option>
                        <option [ngValue]="OrderStatus.Delivered">{{t('delivered')}}</option>
                        <option [ngValue]="OrderStatus.Cancelled">{{t('cancelled')}}</option>
                    </select>
                </div>

                <!-- Clear Filters -->
                <button (click)="clearFilters()" [disabled]="isLoading()" class="btn btn-outline">
                    {{t('clearFilters')}}
                </button>
            </div>
        </div>
    </div>

    <!-- Orders List -->
    <div class="card bg-base-100 shadow-sm border border-base-300">
        <div class="card-body p-0">
            @if (isLoading()) {
                <div class="flex justify-center items-center py-12">
                    <span class="loading loading-spinner loading-lg"></span>
                </div>
            } @else {
                <!-- Desktop / tablet table view -->
                <div class="hidden md:block">
                    <div class="overflow-x-auto">
                        <table class="table table-zebra">
                            <thead>
                                <tr>
                                    <th>{{t('orderNumber')}}</th>
                                    <th>{{t('customer')}}</th>
                                    <th>{{t('items')}}</th>
                                    <th>{{t('total')}}</th>
                                    <th>{{t('status')}}</th>
                                    <th>{{t('orderDate')}}</th>
                                    <th>{{t('actions')}}</th>
                                </tr>
                            </thead>
                            <tbody>
                                @for (order of filteredOrders$(); track order.id) {
                                    <tr>
                                        <td>
                                            <div class="font-semibold text-primary">{{order.orderNumber}}</div>
                                        </td>
                                        <td>
                                            <div class="font-medium">{{order.customerName}}</div>
                                        </td>
                                        <td>
                                            <div class="badge badge-outline">{{order.itemCount}} {{t('items')}}</div>
                                        </td>
                                        <td>
                                            <div class="font-semibold">{{order.total | currency:'KWD'}}</div>
                                        </td>
                                        <td>
                                            <div class="badge" [ngClass]="getOrderStatusClass(order.status)">
                                                {{getOrderStatusText(order.status)}}
                                            </div>
                                        </td>
                                        <td>
                                            <div class="text-sm">{{order.createdAt | date:'short'}}</div>
                                        </td>
                                        <td>
                                            <div class="flex gap-1">
                                                <button 
                                                    (click)="viewOrderDetails(order.id)"
                                                    [disabled]="isLoading()"
                                                    class="btn btn-ghost btn-xs">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                                    </svg>
                                                    {{t('view')}}
                                                </button>
                                                @if (canCancelOrder(order)) {
                                                    <button 
                                                        (click)="cancelOrder(order.id)"
                                                        [disabled]="isLoading()"
                                                        class="btn btn-ghost btn-xs btn-error">
                                                        {{t('cancel')}}
                                                    </button>
                                                }
                                            </div>
                                        </td>
                                    </tr>
                                } @empty {
                                    <tr>
                                        <td colspan="7" class="text-center py-8 text-base-content/50">
                                            {{t('noOrdersFound')}}
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Mobile card view -->
                <div class="md:hidden">
                    @for (order of filteredOrders$(); track order.id) {
                        <div class="border-b border-base-300 last:border-b-0">
                            <div class="p-4 space-y-2">
                                <div class="flex items-start justify-between gap-3">
                                    <div>
                                        <div class="text-xs text-base-content/70 uppercase tracking-wide">
                                            {{t('orderNumber')}}
                                        </div>
                                        <div class="font-semibold text-primary">
                                            {{order.orderNumber}}
                                        </div>
                                        <div class="mt-1 text-xs text-base-content/70">
                                            {{order.createdAt | date:'short'}}
                                        </div>
                                    </div>
                                    <div class="shrink-0">
                                        <div class="badge" [ngClass]="getOrderStatusClass(order.status)">
                                            {{getOrderStatusText(order.status)}}
                                        </div>
                                    </div>
                                </div>

                                <div class="grid grid-cols-2 gap-2 text-sm">
                                    <div>
                                        <div class="text-base-content/70">{{t('customer')}}</div>
                                        <div class="font-medium truncate">{{order.customerName}}</div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-base-content/70">{{t('items')}}</div>
                                        <div class="font-medium">
                                            {{order.itemCount}} {{t('items')}}
                                        </div>
                                    </div>
                                    <div>
                                        <div class="text-base-content/70">{{t('total')}}</div>
                                        <div class="font-semibold">
                                            {{order.total | currency:'KWD'}}
                                        </div>
                                    </div>
                                </div>

                                <div class="flex justify-end gap-2 pt-1">
                                    <button 
                                        (click)="viewOrderDetails(order.id)"
                                        [disabled]="isLoading()"
                                        class="btn btn-ghost btn-xs">
                                        {{t('view')}}
                                    </button>
                                    @if (canCancelOrder(order)) {
                                        <button 
                                            (click)="cancelOrder(order.id)"
                                            [disabled]="isLoading()"
                                            class="btn btn-error btn-xs btn-outline">
                                            {{t('cancel')}}
                                        </button>
                                    }
                                </div>
                            </div>
                        </div>
                    } @empty {
                        <div class="text-center py-8 text-base-content/50">
                            {{t('noOrdersFound')}}
                        </div>
                    }
                </div>
            }
        </div>
    </div>

    <!-- Order Details Modal -->
    @if (showDetailsModal() && selectedOrderDetails()) {
        <div class="modal modal-open">
            <div class="modal-box max-w-4xl w-full max-h-[90vh] overflow-y-auto p-4 md:p-6">
                <h3 class="font-bold text-lg md:text-xl mb-4 break-words">{{t('orderDetails')}} - {{selectedOrderDetails()!.orderNumber}}</h3>
                
                <!-- Order Status -->
                <div class="mb-4">
                    <div class="flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4">
                        <div class="flex items-center flex-wrap gap-2">
                            <span class="text-xs sm:text-sm text-base-content/70">{{t('status')}}:</span>
                            <div class="badge badge-sm sm:badge-lg ml-2" [ngClass]="getOrderStatusClass(selectedOrderDetails()!.status)">
                                {{getOrderStatusText(selectedOrderDetails()!.status)}}
                            </div>
                        </div>
                        <div class="flex items-center flex-wrap gap-2">
                            <span class="text-xs sm:text-sm text-base-content/70">{{t('orderDateLabel')}}:</span>
                            <span class="font-medium text-xs sm:text-sm ml-2">{{selectedOrderDetails()!.createdAt | date:'medium'}}</span>
                        </div>
                    </div>
                </div>

                <div class="divider"></div>

                <!-- Shipping Address -->
                <div class="mb-4">
                    <h4 class="font-semibold mb-2 text-sm sm:text-base">{{t('shippingAddress')}}</h4>
                    <div class="bg-base-200 p-3 sm:p-4 rounded-lg space-y-1">
                        <p class="font-medium text-sm sm:text-base break-words">
                            <span class="text-base-content/70">الاسم:</span> {{selectedOrderDetails()!.shippingAddress.fullName}}
                        </p>
                        <p class="text-xs sm:text-sm text-base-content/70 break-words">
                            <span class="font-medium">الهاتف:</span> {{selectedOrderDetails()!.shippingAddress.phone}}
                        </p>
                        @if (selectedOrderDetails()!.shippingAddress.street) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">الشارع:</span> {{selectedOrderDetails()!.shippingAddress.street}}
                            </p>
                        }
                        @if (selectedOrderDetails()!.shippingAddress.alQataa) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">القطعة:</span> {{selectedOrderDetails()!.shippingAddress.alQataa}}
                            </p>
                        }
                        @if (selectedOrderDetails()!.shippingAddress.alSharee) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">الشارع:</span> {{selectedOrderDetails()!.shippingAddress.alSharee}}
                            </p>
                        }
                        @if (selectedOrderDetails()!.shippingAddress.alJada) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">الجادة:</span> {{selectedOrderDetails()!.shippingAddress.alJada}}
                            </p>
                        }
                        @if (selectedOrderDetails()!.shippingAddress.alManzil) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">المنزل:</span> {{selectedOrderDetails()!.shippingAddress.alManzil}}
                            </p>
                        }
                        @if (selectedOrderDetails()!.shippingAddress.alDor) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">الدور:</span> {{selectedOrderDetails()!.shippingAddress.alDor}}
                            </p>
                        }
                        @if (selectedOrderDetails()!.shippingAddress.alShakka) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">الشقة:</span> {{selectedOrderDetails()!.shippingAddress.alShakka}}
                            </p>
                        }
                        <p class="text-xs sm:text-sm text-base-content/70 break-words">
                            <span class="font-medium">المدينة:</span> {{selectedOrderDetails()!.shippingAddress.city}}
                        </p>
                        @if (selectedOrderDetails()!.shippingAddress.state) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">المحافظة:</span> {{selectedOrderDetails()!.shippingAddress.state}}
                            </p>
                        }
                        @if (selectedOrderDetails()!.shippingAddress.postalCode) {
                            <p class="text-xs sm:text-sm text-base-content/70 break-words">
                                <span class="font-medium">الرمز البريدي:</span> {{selectedOrderDetails()!.shippingAddress.postalCode}}
                            </p>
                        }
                        <p class="text-xs sm:text-sm text-base-content/70 break-words">
                            <span class="font-medium">الدولة:</span> {{selectedOrderDetails()!.shippingAddress.country}}
                        </p>
                    </div>
                </div>

                <div class="divider"></div>

                <!-- Order Items -->
                <div class="mb-4">
                    <h4 class="font-semibold mb-2 text-sm sm:text-base">{{t('orderItems')}}</h4>
                    <div class="overflow-x-auto -mx-4 sm:mx-0">
                        <table class="table table-sm text-xs sm:text-sm">
                            <thead>
                                <tr>
                                    <th class="text-xs sm:text-sm">{{t('product')}}</th>
                                    <th class="text-xs sm:text-sm hidden sm:table-cell">{{t('price')}}</th>
                                    <th class="text-xs sm:text-sm">{{t('quantity')}}</th>
                                    <th class="text-xs sm:text-sm">{{t('total')}}</th>
                                    <th class="text-xs sm:text-sm hidden md:table-cell">{{t('rating')}}</th>
                                    <th class="text-xs sm:text-sm md:hidden">{{t('rating')}}</th>
                                </tr>
                            </thead>
                            <tbody>
                                @for (item of selectedOrderDetails()!.items; track item.id) {
                                    <tr>
                                        <td>
                                            <div class="flex items-center gap-2 sm:gap-3">
                                                @if (item.image) {
                                                    <div class="avatar shrink-0">
                                                        <div class="mask mask-squircle w-8 h-8 sm:w-12 sm:h-12">
                                                            <img [src]="item.image" [alt]="item.name" />
                                                        </div>
                                                    </div>
                                                }
                                                <div class="font-medium text-xs sm:text-sm break-words min-w-0">
                                                    <div>{{item.name}}</div>
                                                    <div class="text-xs text-base-content/70 sm:hidden">{{item.price | currency:'KWD'}} × {{item.quantity}}</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="hidden sm:table-cell">{{item.price | currency:'KWD'}}</td>
                                        <td class="text-xs sm:text-sm">{{item.quantity}}</td>
                                        <td class="font-semibold text-xs sm:text-sm">{{item.total | currency:'KWD'}}</td>
                                        <td class="hidden md:table-cell">
                                            @if (checkingRatings()) {
                                                <span class="loading loading-spinner loading-xs"></span>
                                            } @else {
                                                @if (hasRatedProduct(item.productId)) {
                                                    @let rating = getProductRating(item.productId);
                                                    @if (rating) {
                                                        <div class="flex flex-col gap-1">
                                                            <div class="rating rating-xs">
                                                                @for (star of [1, 2, 3, 4, 5]; track star) {
                                                                    <input 
                                                                        type="radio" 
                                                                        name="rating-display-{{item.productId}}" 
                                                                        class="mask mask-star-2 bg-orange-400" 
                                                                        [checked]="rating.ratingNumber === star"
                                                                        disabled />
                                                                }
                                                            </div>
                                                            @if (rating.content) {
                                                                <div class="text-xs text-base-content/70 max-w-xs truncate" [title]="rating.content">
                                                                    {{rating.content}}
                                                                </div>
                                                            }
                                                            <div class="badge badge-success badge-xs">{{t('rated')}}</div>
                                                        </div>
                                                    }
                                                } @else {
                                                    <button 
                                                        (click)="openRatingModal(item.productId, item.name)"
                                                        [disabled]="isLoading()"
                                                        class="btn btn-primary btn-xs">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 sm:h-4 sm:w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                                                        </svg>
                                                        <span class="hidden sm:inline">{{t('rate')}}</span>
                                                    </button>
                                                }
                                            }
                                        </td>
                                        <!-- Mobile Rating Button -->
                                        <td class="md:hidden">
                                            @if (!checkingRatings() && !hasRatedProduct(item.productId)) {
                                                <button 
                                                    (click)="openRatingModal(item.productId, item.name)"
                                                    [disabled]="isLoading()"
                                                    class="btn btn-primary btn-xs">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                                                    </svg>
                                                </button>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="divider"></div>

                <!-- Order Summary -->
                <div class="bg-base-200 p-3 sm:p-4 rounded-lg">
                    <div class="flex justify-between mb-2 text-xs sm:text-sm">
                        <span class="text-base-content/70">{{t('subtotal')}}:</span>
                        <span class="font-medium">{{selectedOrderDetails()!.subtotal | currency:'KWD'}}</span>
                    </div>
                    @if (selectedOrderDetails()!.couponDiscountAmount && selectedOrderDetails()!.couponDiscountAmount! > 0) {
                        <div class="flex justify-between mb-2 text-success text-xs sm:text-sm">
                            <span>{{t('discount')}} ({{selectedOrderDetails()!.couponCode}}):</span>
                            <span class="font-medium">-{{selectedOrderDetails()!.couponDiscountAmount! | currency:'KWD'}}</span>
                        </div>
                    }
                    <div class="flex justify-between mb-2 text-xs sm:text-sm">
                        <span class="text-base-content/70">{{t('shipping')}}:</span>
                        <span class="font-medium">{{selectedOrderDetails()!.shipping | currency:'KWD'}}</span>
                    </div>
                    <div class="flex justify-between mb-2 text-xs sm:text-sm">
                        <span class="text-base-content/70">{{t('tax')}}:</span>
                        <span class="font-medium">{{selectedOrderDetails()!.tax | currency:'KWD'}}</span>
                    </div>
                    <div class="divider my-2"></div>
                    <div class="flex justify-between text-base sm:text-lg font-bold">
                        <span>{{t('total')}}:</span>
                        <span>{{selectedOrderDetails()!.total | currency:'KWD'}}</span>
                    </div>
                </div>

                <div class="modal-action flex-col sm:flex-row gap-2 mt-4">
                    <button 
                        (click)="downloadInvoice(selectedOrderDetails()!.id)" 
                        [disabled]="isLoading()" 
                        class="btn btn-primary w-full sm:w-auto">
                        @if (isLoading()) {
                            <span class="loading loading-spinner loading-sm"></span>
                        } @else {
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                        }
                        <span class="text-xs sm:text-sm">{{t('downloadInvoice')}}</span>
                    </button>
                    @if (canCancelOrder(selectedOrderDetails()!)) {
                        <button 
                            (click)="cancelOrder(selectedOrderDetails()!.id)" 
                            [disabled]="isLoading()" 
                            class="btn btn-error w-full sm:w-auto">
                            @if (isLoading()) {
                                <span class="loading loading-spinner loading-sm"></span>
                            }
                            <span class="text-xs sm:text-sm">{{t('cancelOrder')}}</span>
                        </button>
                    }
                    <button (click)="closeDetailsModal()" [disabled]="isLoading()" class="btn w-full sm:w-auto text-xs sm:text-sm">{{t('close')}}</button>
                </div>
            </div>
        </div>
    }

    <!-- Rating Modal -->
    @if (showRatingModal() && selectedProductForRating()) {
        <div class="modal modal-open">
            <div class="modal-box max-w-2xl w-full max-h-[90vh] overflow-y-auto p-4 md:p-6">
                <h3 class="font-bold text-base sm:text-lg mb-4 break-words">{{t('rateProduct')}}: {{selectedProductForRating()!.productName}}</h3>
                
                <!-- Rating Stars -->
                <div class="mb-4">
                    <label class="label py-2">
                        <span class="label-text font-semibold text-sm sm:text-base">{{t('yourRating')}}</span>
                    </label>
                    <div class="rating rating-md sm:rating-lg justify-center sm:justify-start">
                        @for (star of [1, 2, 3, 4, 5]; track star) {
                            <input 
                                type="radio" 
                                name="rating" 
                                class="mask mask-star-2 bg-orange-400" 
                                [checked]="ratingForm().ratingNumber === star"
                                (click)="updateRatingNumber(star)" />
                        }
                    </div>
                    <div class="label py-1">
                        <span class="label-text-alt text-xs sm:text-sm text-base-content/70">
                            {{t('selectedStars')}}: {{ratingForm().ratingNumber}} {{t('outOfStars')}}
                        </span>
                    </div>
                </div>

                <!-- Review Comment -->
                <div class="form-control mb-4">
                    <label class="label py-2">
                        <span class="label-text font-semibold text-sm sm:text-base">{{t('yourReview')}}</span>
                        <span class="label-text-alt text-xs sm:text-sm text-base-content/70">{{t('required')}}</span>
                    </label>
                    <textarea 
                        class="textarea textarea-bordered h-24 sm:h-32 text-sm" 
                        [placeholder]="t('shareExperience')"
                        [ngModel]="ratingForm().content"
                        (ngModelChange)="updateRatingContent($event)"
                        maxlength="1000">
                    </textarea>
                    <label class="label py-1">
                        <span class="label-text-alt text-xs text-base-content/70">
                            {{ratingForm().content.length}} / 1000 {{t('characters')}}
                        </span>
                    </label>
                </div>

                <div class="modal-action flex-col sm:flex-row gap-2">
                    <button 
                        (click)="closeRatingModal()" 
                        [disabled]="isLoading()" 
                        class="btn btn-ghost w-full sm:w-auto text-xs sm:text-sm">
                        {{t('cancel')}}
                    </button>
                    <button 
                        (click)="submitRating()" 
                        [disabled]="isLoading() || !ratingForm().content.trim()" 
                        class="btn btn-primary w-full sm:w-auto">
                        @if (isLoading()) {
                            <span class="loading loading-spinner loading-sm"></span>
                        }
                        <span class="text-xs sm:text-sm">{{t('submitRating')}}</span>
                    </button>
                </div>
            </div>
        </div>
    }

    <!-- Toast Component -->
    <app-toast 
        [toasts]="toasts" 
        (close)="onToastClose($event)">
    </app-toast>
    
</div>
